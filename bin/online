#! /bin/bash

function check() {
  default=$(ip r | grep default | cut -d ' ' -f 3 | head -n 1)
  [ ! -z "$default" ] && ping -q -w 1 -c 1 $default > /dev/null
}

case "$1" in
  "-w"|"--wait") while $(! check); do sleep 1; done ;;
  "") check ;;
  *) echo "usage: $0 [-w|--wait]"; exit 2 ;;
esac

